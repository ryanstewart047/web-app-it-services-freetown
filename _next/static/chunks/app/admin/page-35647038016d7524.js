(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{2802:function(e,r,t){Promise.resolve().then(t.bind(t,9789))},9789:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return n}});var a=t(7437),s=t(2265);let d=()=>localStorage.getItem("admin-key")||"admin123";function n(){var e,r,t,n,m,u,p,y,h,b,f,k,v,j,w;let[N,C]=(0,s.useState)(!1),[S,L]=(0,s.useState)(""),[_,A]=(0,s.useState)(""),[E,R]=(0,s.useState)(!1),[I,T]=(0,s.useState)({}),[B,M]=(0,s.useState)({}),[U,F]=(0,s.useState)({}),[O,W]=(0,s.useState)(!1),[q,D]=(0,s.useState)(""),[P,V]=(0,s.useState)(""),[z,H]=(0,s.useState)(""),[K,$]=(0,s.useState)(""),[Y,J]=(0,s.useState)("");(0,s.useEffect)(()=>{"true"===localStorage.getItem("admin-authenticated")&&(C(!0),Q())},[]);let Q=async()=>{R(!0);try{let[e,r,t]=await Promise.all([fetch("/api/analytics/visitor/"),fetch("/api/analytics/forms/"),fetch("/api/analytics/repairs/")]);if(e.ok){let r=await e.json();T(r)}if(r.ok){let e=await r.json();M(e)}if(t.ok){let e=await t.json();F(e)}}catch(e){console.error("Error loading data:",e)}finally{R(!1)}},G=(0,s.useMemo)(()=>{var e;return Object.entries(null!==(e=U.statusCounts)&&void 0!==e?e:{}).map(e=>{let[r,t]=e;return{label:r,count:t}})},[U.statusCounts]);return N?(0,a.jsxs)("div",{className:"space-y-8 sm:space-y-10 lg:space-y-12",children:[(0,a.jsxs)("section",{id:"overview",className:"grid gap-6 lg:grid-cols-[1.15fr,0.85fr]",children:[(0,a.jsxs)("div",{className:"relative overflow-hidden rounded-3xl border border-gray-200/70 bg-white p-6 shadow-sm sm:p-8 dark:border-gray-800/70 dark:bg-gray-900",children:[(0,a.jsx)("div",{className:"absolute right-0 top-0 h-48 w-48 translate-x-16 -translate-y-10 rounded-full bg-red-500/10 blur-3xl","aria-hidden":"true"}),(0,a.jsxs)("div",{className:"relative flex flex-col justify-between gap-6 lg:flex-row lg:gap-8",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-gray-500 dark:text-gray-500 sm:text-sm",children:"Snapshot"}),(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-gray-50 sm:text-3xl",children:"Welcome back! Here's the latest pulse on IT Services Freetown."}),(0,a.jsx)("p",{className:"max-w-2xl text-sm text-gray-600 dark:text-gray-400",children:"Monitor visitor growth, form activity, and repair progress across every service touchpoint."})]}),(0,a.jsxs)("div",{className:"w-full self-start rounded-2xl border border-gray-200 bg-white/90 p-4 text-sm shadow-sm sm:max-w-md sm:p-5 dark:border-gray-800 dark:bg-gray-950/60",children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-gray-500 dark:text-gray-500",children:"Quick controls"}),(0,a.jsxs)("div",{className:"mt-3 flex flex-col gap-2 sm:flex-row sm:flex-wrap sm:items-center sm:gap-3",children:[(0,a.jsxs)("button",{onClick:Q,className:"inline-flex items-center gap-2 rounded-xl bg-gray-900 px-4 py-2 text-sm font-medium text-white transition hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:bg-red-600 dark:hover:bg-red-500",children:[(0,a.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh data"]}),(0,a.jsxs)("button",{onClick:()=>W(!0),className:"inline-flex items-center gap-2 rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 transition hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",children:[(0,a.jsxs)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]}),(0,a.jsxs)("button",{onClick:()=>{C(!1),localStorage.removeItem("admin-authenticated"),L(""),T({}),M({}),F({}),W(!1)},className:"inline-flex items-center gap-2 rounded-xl border border-red-200 bg-white px-4 py-2 text-sm font-medium text-red-600 transition hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:border-red-800 dark:bg-gray-800 dark:text-red-400 dark:hover:bg-gray-700",children:[(0,a.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]}),(0,a.jsx)("span",{className:"rounded-xl border border-gray-200 px-3 py-2 text-xs font-medium text-gray-600 dark:border-gray-700 dark:text-gray-400",children:E?"Syncing latest metrics…":"Data synced with live services"})]})]})]}),(0,a.jsxs)("dl",{className:"mt-8 grid gap-4 min-[480px]:grid-cols-2",children:[(0,a.jsx)(l,{label:"Total visitors",value:null!==(e=I.totalVisitors)&&void 0!==e?e:0,accent:"text-blue-500"}),(0,a.jsx)(l,{label:"Total repairs",value:null!==(r=U.totalRepairs)&&void 0!==r?r:0,accent:"text-purple-500"}),(0,a.jsx)(l,{label:"Form submissions",value:null!==(t=B.totalSubmissions)&&void 0!==t?t:0,accent:"text-emerald-500"}),(0,a.jsx)(l,{label:"Revenue",value:"$".concat((null!==(n=U.totalRevenue)&&void 0!==n?n:0).toLocaleString()),accent:"text-orange-500"})]})]}),(0,a.jsxs)("div",{className:"grid gap-4 min-[480px]:grid-cols-2",children:[(0,a.jsx)(i,{title:"Unique visitors",value:null!==(m=I.uniqueVisitors)&&void 0!==m?m:0,helper:"Compared to last 7 days",iconBg:"bg-blue-100 dark:bg-blue-900/40"}),(0,a.jsx)(i,{title:"Average session",value:"".concat(null!==(u=I.avgSessionDuration)&&void 0!==u?u:0," min"),helper:"Engagement quality",iconBg:"bg-indigo-100 dark:bg-indigo-900/40"}),(0,a.jsx)(i,{title:"Forms viewed",value:null!==(p=B.totalViews)&&void 0!==p?p:0,helper:"Across all funnels",iconBg:"bg-emerald-100 dark:bg-emerald-900/40"}),(0,a.jsx)(i,{title:"Conversion",value:"".concat(null!==(y=B.overallConversionRate)&&void 0!==y?y:0,"%"),helper:"Submission rate",iconBg:"bg-amber-100 dark:bg-amber-900/40"})]})]}),(0,a.jsxs)("section",{id:"analytics",className:"space-y-6",children:[(0,a.jsx)(c,{title:"Analytics",description:"Traffic and engagement signals across your digital touchpoints."}),(0,a.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4",children:[(0,a.jsx)(x,{label:"Total visitors",value:null!==(h=I.totalVisitors)&&void 0!==h?h:0,trendLabel:"All traffic"}),(0,a.jsx)(x,{label:"Unique visitors",value:null!==(b=I.uniqueVisitors)&&void 0!==b?b:0,trendLabel:"New users"}),(0,a.jsx)(x,{label:"Bounce rate",value:"".concat(null!==(f=I.bounceRate)&&void 0!==f?f:0,"%"),trendLabel:"Lower is better"}),(0,a.jsx)(x,{label:"Avg session",value:"".concat(null!==(k=I.avgSessionDuration)&&void 0!==k?k:0," min"),trendLabel:"Time on site"})]})]}),(0,a.jsxs)("section",{id:"forms",className:"space-y-6",children:[(0,a.jsx)(c,{title:"Forms",description:"Capture insights, track submissions, and monitor engagement across funnels."}),(0,a.jsxs)("div",{className:"rounded-3xl border border-gray-200 bg-white p-5 shadow-sm sm:p-6 dark:border-gray-800 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"grid gap-4 min-[480px]:grid-cols-2 md:grid-cols-3",children:[(0,a.jsx)(g,{label:"Submissions",value:null!==(v=B.totalSubmissions)&&void 0!==v?v:0}),(0,a.jsx)(g,{label:"Views",value:null!==(j=B.totalViews)&&void 0!==j?j:0}),(0,a.jsx)(g,{label:"Conversion rate",value:"".concat(null!==(w=B.overallConversionRate)&&void 0!==w?w:0,"%")})]}),B.recentSubmissions&&B.recentSubmissions.length>0?(0,a.jsx)("div",{className:"mt-6 overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 text-sm dark:divide-gray-800",children:[(0,a.jsx)("thead",{className:"bg-gray-50 text-left uppercase tracking-wide dark:bg-gray-800/60",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3 font-semibold text-gray-500 dark:text-gray-400",children:"Form"}),(0,a.jsx)("th",{className:"px-4 py-3 font-semibold text-gray-500 dark:text-gray-400",children:"Submitted"}),(0,a.jsx)("th",{className:"px-4 py-3 font-semibold text-gray-500 dark:text-gray-400",children:"Key details"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-800",children:B.recentSubmissions.slice(0,6).map((e,r)=>{var t,s,d;return(0,a.jsxs)("tr",{className:"hover:bg-gray-50/70 dark:hover:bg-gray-800/60",children:[(0,a.jsx)("td",{className:"px-4 py-3 font-medium text-gray-900 dark:text-gray-100",children:null!==(t=e.formType)&&void 0!==t?t:"Unknown form"}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-500 dark:text-gray-400",children:null!==(s=e.timestamp)&&void 0!==s?s:"—"}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-500 dark:text-gray-400",children:e.fields?Object.entries(e.fields).slice(0,2).map(e=>{let[r,t]=e;return(0,a.jsxs)("div",{className:"truncate text-xs",children:[(0,a.jsxs)("span",{className:"font-medium text-gray-600 dark:text-gray-300",children:[r,": "]}),(0,a.jsx)("span",{children:t})]},r)}):"No details captured"})]},"".concat(null!==(d=e.timestamp)&&void 0!==d?d:r,"-").concat(r))})})]})}):(0,a.jsx)("p",{className:"mt-6 rounded-2xl border border-dashed border-gray-300 px-4 py-6 text-center text-sm text-gray-500 dark:border-gray-700 dark:text-gray-500",children:"No recent submissions to show. Once forms are submitted, they will appear here automatically."})]})]}),(0,a.jsxs)("section",{id:"repairs",className:"space-y-6",children:[(0,a.jsx)(c,{title:"Repair operations",description:"Track active jobs, update statuses, and keep customers informed."}),(0,a.jsx)(o,{repairs:U,onUpdate:Q,statusSummary:G})]}),O&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 backdrop-blur-sm",children:(0,a.jsxs)("div",{className:"w-full max-w-lg overflow-hidden rounded-3xl border border-gray-200 bg-white shadow-2xl dark:border-gray-800 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-gray-800 via-gray-900 to-black p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase tracking-[0.4em] text-gray-400",children:"Security"}),(0,a.jsx)("h2",{className:"mt-2 text-2xl font-semibold",children:"Change Access Key"})]}),(0,a.jsx)("button",{onClick:()=>{W(!1),$(""),J(""),D(""),V(""),H("")},className:"rounded-xl p-2 text-gray-400 transition hover:bg-white/10 hover:text-white",children:(0,a.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-300",children:"Update your admin access key. You must verify your current key before setting a new one."})]}),(0,a.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),$(""),J(""),q.trim()!==d().trim()){$("Current access key is incorrect.");return}if(P.trim().length<6){$("New access key must be at least 6 characters long.");return}if(P.trim()!==z.trim()){$("New access key and confirmation do not match.");return}localStorage.setItem("admin-key",P.trim()),J("Access key changed successfully!"),setTimeout(()=>{D(""),V(""),H(""),W(!1),J("")},2e3)},className:"space-y-5 p-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"current-key",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Current Access Key"}),(0,a.jsx)("input",{id:"current-key",type:"password",value:q,onChange:e=>D(e.target.value),required:!0,className:"w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-900 transition focus:border-red-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-red-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 dark:focus:border-red-400 dark:focus:ring-red-900/60",placeholder:"Enter current key"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"new-key",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"New Access Key"}),(0,a.jsx)("input",{id:"new-key",type:"password",value:P,onChange:e=>V(e.target.value),required:!0,minLength:6,className:"w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-900 transition focus:border-red-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-red-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 dark:focus:border-red-400 dark:focus:ring-red-900/60",placeholder:"Enter new key (min. 6 characters)"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"confirm-key",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Confirm New Access Key"}),(0,a.jsx)("input",{id:"confirm-key",type:"password",value:z,onChange:e=>H(e.target.value),required:!0,minLength:6,className:"w-full rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-900 transition focus:border-red-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-red-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 dark:focus:border-red-400 dark:focus:ring-red-900/60",placeholder:"Re-enter new key"})]}),K&&(0,a.jsxs)("div",{className:"flex items-start gap-3 rounded-xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700 dark:border-red-900/50 dark:bg-red-900/30 dark:text-red-200",children:[(0,a.jsx)("svg",{className:"mt-0.5 h-4 w-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("span",{children:K})]}),Y&&(0,a.jsxs)("div",{className:"flex items-start gap-3 rounded-xl border border-green-200 bg-green-50 px-4 py-3 text-sm text-green-700 dark:border-green-900/50 dark:bg-green-900/30 dark:text-green-200",children:[(0,a.jsx)("svg",{className:"mt-0.5 h-4 w-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("span",{children:Y})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{W(!1),$(""),J(""),D(""),V(""),H("")},className:"flex-1 rounded-xl border border-gray-300 bg-white px-4 py-3 text-sm font-medium text-gray-700 transition hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"flex-1 rounded-xl bg-gray-900 px-4 py-3 text-sm font-medium text-white transition hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:bg-red-600 dark:hover:bg-red-500",children:"Update Key"})]})]})]})})]}):(0,a.jsx)("div",{className:"flex min-h-[70vh] items-center justify-center px-4",children:(0,a.jsxs)("div",{className:"w-full max-w-lg overflow-hidden rounded-3xl border border-gray-200 bg-white shadow-xl dark:border-gray-800 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-br from-red-500 via-red-600 to-red-700 p-8 text-white",children:[(0,a.jsx)("p",{className:"text-sm uppercase tracking-[0.4em] text-red-100/80",children:"Secure Area"}),(0,a.jsx)("h2",{className:"mt-4 text-3xl font-semibold",children:"Admin Control Access"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-red-100",children:"Enter the admin key to reach live analytics, customer requests, and repair pipelines."})]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),A(""),S.trim()===d().trim()?(C(!0),localStorage.setItem("admin-authenticated","true"),Q()):A("Invalid access key. Please try again.")},className:"space-y-6 bg-white px-8 py-10 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"password",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Admin Access Key"}),(0,a.jsxs)("div",{className:"relative flex items-center",children:[(0,a.jsx)("span",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-4 text-gray-400",children:(0,a.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11c1.657 0 3-.895 3-2s-1.343-2-3-2-3 .895-3 2 1.343 2 3 2zm0 0v1a3 3 0 003 3h3a3 3 0 003-3v-1m-6 0v-1a3 3 0 00-3-3H9a3 3 0 00-3 3v1"})})}),(0,a.jsx)("input",{id:"password",name:"password",type:"password",value:S,onChange:e=>L(e.target.value),required:!0,className:"w-full rounded-2xl border border-gray-200 bg-gray-50 py-3 pl-12 pr-4 text-sm text-gray-900 shadow-sm transition focus:border-red-500 focus:bg-white focus:outline-none focus:ring-2 focus:ring-red-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100 dark:focus:border-red-400 dark:focus:ring-red-900/60",placeholder:"Enter admin key"})]})]}),_?(0,a.jsxs)("div",{className:"flex items-start gap-3 rounded-2xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700 dark:border-red-900/50 dark:bg-red-900/30 dark:text-red-200",children:[(0,a.jsx)("svg",{className:"mt-0.5 h-4 w-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("span",{children:_})]}):null,(0,a.jsxs)("button",{type:"submit",className:"flex w-full items-center justify-center gap-2 rounded-2xl bg-gray-900 py-3 text-sm font-semibold text-white transition hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:bg-red-600 dark:hover:bg-red-500",children:[(0,a.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Unlock Dashboard"]})]}),(0,a.jsx)("p",{className:"px-8 pb-8 text-center text-xs text-gray-500 dark:text-gray-500",children:"Protected & monitored — contact system administrator for support."})]})})}function o(e){var r,t,d,n;let{repairs:o,onUpdate:l,statusSummary:i}=e,[c,x]=(0,s.useState)(null),[m,u]=(0,s.useState)({status:"",notes:"",totalCost:""});(0,s.useEffect)(()=>{var e,r;if(!c){u({status:"",notes:"",totalCost:""});return}u({status:null!==(e=c.status)&&void 0!==e?e:"",notes:null!==(r=c.issueSummary)&&void 0!==r?r:"",totalCost:c.totalCost?String(c.totalCost):""})},[c]);let p=async()=>{if(c)try{(await fetch("/api/analytics/repairs/",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({trackingId:c.trackingId,status:m.status,notes:m.notes,totalCost:m.totalCost?parseFloat(m.totalCost):void 0})})).ok?(alert("Repair updated successfully!"),x(null),l()):alert("Failed to update repair")}catch(e){console.error("Error updating repair:",e),alert("Error updating repair")}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid gap-4 min-[480px]:grid-cols-2 xl:grid-cols-4",children:[(0,a.jsx)(g,{label:"Total repairs",value:null!==(r=o.totalRepairs)&&void 0!==r?r:0}),(0,a.jsx)(g,{label:"Average completion",value:"".concat(null!==(t=o.averageCompletionDays)&&void 0!==t?t:0," days")}),(0,a.jsx)(g,{label:"Live revenue",value:"$".concat((null!==(d=o.totalRevenue)&&void 0!==d?d:0).toLocaleString())}),(0,a.jsx)(g,{label:"Statuses tracked",value:i.length})]}),i.length?(0,a.jsx)("div",{className:"flex w-full flex-wrap gap-2 rounded-2xl border border-gray-200 bg-white p-4 text-xs uppercase tracking-wide text-gray-600 shadow-sm dark:border-gray-800 dark:bg-gray-900 dark:text-gray-400",children:i.map(e=>(0,a.jsxs)("span",{className:"rounded-full border border-current px-3 py-1 text-[11px] font-semibold uppercase tracking-wider text-gray-700 dark:border-gray-700 dark:text-gray-300",children:[e.label,": ",e.count]},e.label))}):null,(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-[3fr,2fr]",children:[(0,a.jsxs)("div",{className:"space-y-4 overflow-hidden rounded-3xl border border-gray-200 bg-white p-4 shadow-sm sm:p-5 dark:border-gray-800 dark:bg-gray-900",children:[(0,a.jsx)("h3",{className:"px-2 text-sm font-semibold uppercase tracking-[0.3em] text-gray-500 dark:text-gray-500",children:"Active queue"}),(0,a.jsx)("div",{className:"max-h-[26rem] space-y-3 overflow-y-auto pr-2",children:o.allRepairs&&o.allRepairs.length?o.allRepairs.map(e=>{var r,t,s;return(0,a.jsxs)("button",{onClick:()=>x(e),className:"w-full rounded-2xl border px-4 py-3 text-left text-sm transition hover:border-red-400 hover:shadow-md dark:hover:border-red-500/60 ".concat((null==c?void 0:c.trackingId)===e.trackingId?"border-red-500 bg-red-500/10 text-red-600 dark:border-red-400 dark:bg-red-500/10 dark:text-red-200":"border-gray-200 bg-white text-gray-700 dark:border-gray-800 dark:bg-gray-900 dark:text-gray-200"),children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,a.jsx)("div",{className:"font-semibold",children:e.trackingId}),(0,a.jsx)("span",{className:"rounded-full border border-current px-2 py-0.5 text-[11px] uppercase tracking-wide",children:null!==(r=e.status)&&void 0!==r?r:"pending"})]}),(0,a.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-xs text-gray-500 dark:text-gray-400",children:[(0,a.jsx)("span",{children:null!==(t=e.deviceType)&&void 0!==t?t:"Unknown device"}),(0,a.jsx)("span",{children:"•"}),(0,a.jsx)("span",{children:null!==(s=e.customerName)&&void 0!==s?s:"No customer name"}),e.totalCost?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:["$",e.totalCost]})]}):null,e.lastUpdated?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:"•"}),(0,a.jsxs)("span",{children:["Updated ",e.lastUpdated]})]}):null]})]},e.trackingId)}):(0,a.jsx)("p",{className:"rounded-2xl border border-dashed border-gray-300 px-4 py-6 text-center text-sm text-gray-500 dark:border-gray-700 dark:text-gray-500",children:"No repair jobs are currently being tracked. Pending jobs will show up here automatically."})})]}),(0,a.jsxs)("div",{className:"space-y-4 rounded-3xl border border-gray-200 bg-white p-5 shadow-sm sm:p-6 dark:border-gray-800 dark:bg-gray-900",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsx)("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg",children:"Update repair"}),c?(0,a.jsx)("button",{onClick:()=>x(null),className:"text-xs font-semibold uppercase tracking-[0.3em] text-red-500 transition hover:text-red-400",children:"Clear"}):null]}),c?(0,a.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,a.jsxs)("div",{className:"rounded-2xl bg-gray-50 px-4 py-3 text-xs text-gray-600 shadow-inner dark:bg-gray-800/70 dark:text-gray-400",children:[(0,a.jsx)("p",{className:"font-semibold uppercase tracking-[0.3em] text-gray-500 dark:text-gray-500",children:"Editing"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100 sm:text-base",children:c.trackingId}),(0,a.jsx)("p",{className:"mt-1 text-sm sm:text-xs",children:null!==(n=c.issueSummary)&&void 0!==n?n:"No additional notes recorded."})]}),(0,a.jsxs)("label",{className:"space-y-2",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Status"}),(0,a.jsxs)("select",{value:m.status,onChange:e=>u(r=>({...r,status:e.target.value})),className:"w-full rounded-2xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100",children:[(0,a.jsx)("option",{value:"",children:"Select status"}),["received","submitted","diagnosed","in-progress","completed","ready-for-pickup","cancelled"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("label",{className:"space-y-2",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Internal notes"}),(0,a.jsx)("textarea",{rows:3,value:m.notes,onChange:e=>u(r=>({...r,notes:e.target.value})),className:"w-full resize-y rounded-2xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100",placeholder:"Share technician notes or next steps"})]}),(0,a.jsxs)("label",{className:"space-y-2",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:"Total cost (USD)"}),(0,a.jsx)("input",{type:"number",min:"0",step:"0.01",value:m.totalCost,onChange:e=>u(r=>({...r,totalCost:e.target.value})),className:"w-full rounded-2xl border border-gray-200 bg-white px-3 py-2 text-sm text-gray-900 shadow-sm focus:border-red-500 focus:outline-none focus:ring-2 focus:ring-red-200 dark:border-gray-700 dark:bg-gray-800 dark:text-gray-100"})]}),(0,a.jsxs)("button",{onClick:p,className:"flex w-full items-center justify-center gap-2 rounded-2xl bg-gray-900 px-4 py-2 text-sm font-semibold text-white transition hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 dark:bg-red-600 dark:hover:bg-red-500",children:[(0,a.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Apply update"]})]}):(0,a.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Select a repair from the queue to review its details and apply updates. Customers are notified automatically when changes are saved."})]})]})]})}function l(e){let{label:r,value:t,accent:s}=e;return(0,a.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-white/80 px-4 py-3 shadow-sm backdrop-blur dark:border-gray-800 dark:bg-gray-900/80",children:[(0,a.jsx)("dt",{className:"text-[11px] font-medium uppercase tracking-[0.4em] text-gray-500 dark:text-gray-500 sm:text-xs",children:r}),(0,a.jsx)("dd",{className:"mt-2 text-xl font-semibold sm:text-2xl ".concat(s),children:t})]})}function i(e){let{title:r,value:t,helper:s,iconBg:d}=e;return(0,a.jsxs)("div",{className:"rounded-3xl border border-gray-200 bg-white p-4 shadow-sm transition hover:shadow-md sm:p-5 dark:border-gray-800 dark:bg-gray-900",children:[(0,a.jsx)("div",{className:"mb-4 inline-flex h-9 w-9 items-center justify-center rounded-2xl sm:h-10 sm:w-10 ".concat(d),children:(0,a.jsx)("span",{className:"text-lg",children:"★"})}),(0,a.jsx)("p",{className:"text-[11px] uppercase tracking-[0.3em] text-gray-500 dark:text-gray-500 sm:text-xs",children:s}),(0,a.jsx)("h3",{className:"mt-1 text-base font-semibold text-gray-900 dark:text-gray-100 sm:text-lg",children:r}),(0,a.jsx)("p",{className:"mt-2 text-xl font-semibold text-gray-900 dark:text-white sm:text-2xl",children:t})]})}function c(e){let{title:r,description:t}=e;return(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.4em] text-red-500/80 dark:text-red-400/80 sm:text-xs",children:"Section"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-50 sm:text-2xl",children:r}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t})]})}function x(e){let{label:r,value:t,trendLabel:s}=e;return(0,a.jsxs)("div",{className:"rounded-3xl border border-gray-200 bg-white p-4 shadow-sm transition hover:border-red-200 hover:shadow-md sm:p-5 dark:border-gray-800 dark:bg-gray-900",children:[(0,a.jsx)("p",{className:"text-[11px] uppercase tracking-[0.3em] text-gray-500 dark:text-gray-500 sm:text-xs",children:s}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-semibold text-gray-600 dark:text-gray-300",children:r}),(0,a.jsx)("p",{className:"mt-4 text-2xl font-semibold text-gray-900 dark:text-white sm:text-3xl",children:t})]})}function g(e){let{label:r,value:t}=e;return(0,a.jsxs)("div",{className:"rounded-2xl border border-gray-200 bg-gray-50 px-4 py-3 text-sm text-gray-700 shadow-sm dark:border-gray-800 dark:bg-gray-800/60 dark:text-gray-300",children:[(0,a.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.3em] text-gray-500 dark:text-gray-500 sm:text-xs",children:r}),(0,a.jsx)("p",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-gray-100 sm:text-xl",children:t})]})}},622:function(e,r,t){"use strict";var a=t(2265),s=Symbol.for("react.element"),d=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function i(e,r,t){var a,d={},i=null,c=null;for(a in void 0!==t&&(i=""+t),void 0!==r.key&&(i=""+r.key),void 0!==r.ref&&(c=r.ref),r)n.call(r,a)&&!l.hasOwnProperty(a)&&(d[a]=r[a]);if(e&&e.defaultProps)for(a in r=e.defaultProps)void 0===d[a]&&(d[a]=r[a]);return{$$typeof:s,type:e,key:i,ref:c,props:d,_owner:o.current}}r.Fragment=d,r.jsx=i,r.jsxs=i},7437:function(e,r,t){"use strict";e.exports=t(622)}},function(e){e.O(0,[971,938,744],function(){return e(e.s=2802)}),_N_E=e.O()}]);